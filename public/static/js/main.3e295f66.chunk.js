(this["webpackJsonpmonday-integration-quickstart-app"]=this["webpackJsonpmonday-integration-quickstart-app"]||[]).push([[0],{16:function(e,t,n){},35:function(e,t,n){e.exports=n(97)},40:function(e,t,n){},97:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(4),c=n.n(o),u=(n(40),n(1)),s=n.n(u),i=n(2),l=n(5),p=n(6),f=n(8),d=n(7),m=(n(16),n(17),n(14)),v=n(33),h=n.n(v),x=(n(56),n(61),"https://test-monday-pipl.herokuapp.com");function b(){return(b=Object(i.a)(s.a.mark((function e(t,n){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("query -> window.location.origin",window.location.origin),e.next=3,fetch(x+"/api/monday/test",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({colData:{prefix:t,targetCol:n}})});case 3:return a=e.sent,e.next=6,a.json();case 6:return a=e.sent,console.log("query -> res",a),e.abrupt("return",a.data);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(){return(y=Object(i.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(x+"/api/monday/prefixMap",{method:"get",headers:{"Content-Type":"application/json"}});case 2:return t=e.sent,e.next=5,t.json();case 5:return t=e.sent,console.log("getPrefixMap -> res",t),e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(){return(g=Object(i.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(x+"/api/monday/getPrefixMap/",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({boardId:t})});case 2:return n=e.sent,e.next=5,n.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(){return(w=Object(i.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(x+"/api/monday/updatePrefixMap",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({prefixMap:t})});case 2:return n=e.sent,e.next=5,n.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var j={query:function(e,t){return b.apply(this,arguments)},getPrefixMap:function(){return y.apply(this,arguments)},updatePrefixMap:function(e){return w.apply(this,arguments)},getPrefixMapByBoardId:function(e){return g.apply(this,arguments)}},C=n(13),O=n(34);var k=function(e){e.setSelectedColumn;var t=e.columns,n=e.createColumn,o=e.testCall;console.log("AddColumn -> columns",t);var c=Object(a.useState)(""),u=Object(C.a)(c,2),s=u[0],i=u[1],l=Object(a.useState)(null),p=Object(C.a)(l,2),f=p[0],d=p[1],m=t.map((function(e){return{value:e.id,label:e.title}}));return console.log("AddColumn -> options",m),r.a.createElement("form",{className:"add-column"},r.a.createElement(O.a,{placeholder:"Choose a source column",value:f,options:m,onChange:function(e){d(e)}}),r.a.createElement("input",{placeholder:"Choose target column prefix",onInput:function(e){var t=e.target.value;t&&i(t)},name:"prefix",value:s}),r.a.createElement("button",{onClick:function(e){e.preventDefault(),(null===f||void 0===f?void 0:f.value)&&n(f.value)}},"Add Column"),r.a.createElement("button",{onClick:function(e){return o(e,s,f)}},"Test"))},M=h()(),I=function(e){Object(f.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={settings:{background:"#e2445c",attentionBoxTitle:"Hey",attentionBoxType:"danger"},name:"",nextNum:null,columns:null,selectedColumn:null,prefixMap:null},e.getItemsIds=function(){var e=Object(i.a)(s.a.mark((function e(t){var n,a,r,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="\n    query \n      { boards (ids:".concat(t,") \n        { items {\n           id\n      \n          }\n        }\n      }"),e.next=3,M.api(n);case 3:return a=e.sent,r=a.data,o=r.boards[0].items,e.abrupt("return",o.map((function(e){return e.id})));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.createColumn=function(){var t=Object(i.a)(s.a.mark((function t(n){var a,r,o,c,u,l,p;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.state.boardId,r="mutation {\n      create_column(board_id: ".concat(a,', title: "PERSITENT ID", column_type: text) {\n        id\n      }\n    }'),t.next=4,M.api(r);case 4:return o=t.sent,c=o.data.create_column.id,t.next=8,e.getColPrefixs(n,a);case 8:return u=t.sent,console.log("createColumn= -> colPrefixs",u),t.next=12,e.getItemsIds(a);case 12:return l=t.sent,t.next=15,j.getPrefixMapByBoardId(a);case 15:return p=(p=t.sent)||{map:{},boardId:a},l.forEach(function(){var t=Object(i.a)(s.a.mark((function t(n,o){var i,l;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=u[o],t.next=3,e.getPrefixCount(i,p);case 3:return l=t.sent,r=" mutation {\n            change_simple_column_value (board_id: ".concat(a,", item_id: ").concat(n,', column_id: "').concat(c,'", value: ').concat(i+l,") {\n              id\n            }\n          }"),t.next=7,M.api(r);case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),t.next=20,e.savePrefixMap(p,c);case 20:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.getColPrefixs=function(){var e=Object(i.a)(s.a.mark((function e(t,n){var a,r,o,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="query\n                     {  boards (ids:".concat(n,") \n                         { items {\n                           column_values {\n                             id\n                             text\n                            }\n                         }\n                       }\n                     }"),e.next=3,M.api(a);case 3:return r=e.sent,o=r.data.boards,c=o[0].items,e.abrupt("return",c.map((function(e){return e.column_values.find((function(e){return e.id===t})).text})));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),e.getPrefixCount=function(){var e=Object(i.a)(s.a.mark((function e(t,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.map[t]=n.map[t]?n.map[t]+1:1,e.abrupt("return",n.map[t]);case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),e.savePrefixMap=function(){var e=Object(i.a)(s.a.mark((function e(t,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(null===t||void 0===t?void 0:t.targetColId)||(t.targetColId=n),console.log("savePrefixMap= -> prefixMap",t),e.next=4,j.updatePrefixMap(t);case 4:e.sent;case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),e.testCall=function(){var e=Object(i.a)(s.a.mark((function e(t,n,a){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,j.updatePrefixMap();case 3:r=e.sent,console.log("prefixMap",r);case 5:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),e.setSelectedColumn=function(t){e.setState({selectedColumn:t})},e}return Object(p.a)(n,[{key:"componentDidMount",value:function(){var e=Object(i.a)(s.a.mark((function e(){var t,n=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M.listen("context",function(){var e=Object(i.a)(s.a.mark((function e(a){var r,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.data.boardIds[0],n.setState(Object(m.a)(Object(m.a)({},n.state),{},{boardId:r})),t="query {boards (ids:".concat(n.state.boardId,"){\n        columns {\n          id\n          title\n          type\n        }\n      }}"),e.next=5,M.api(t);case 5:a=e.sent,o=a.data.boards[0].columns,console.log("awaitmonday.listen -> columns",o),n.setState({columns:o});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.columns;return e?r.a.createElement("div",{className:"container"},r.a.createElement(k,{setSelectedColumn:this.setSelectedColumn,columns:e,testCall:this.testCall,createColumn:this.createColumn})):r.a.createElement("div",null,"Loading..")}}]),n}(r.a.Component),P=function(e){Object(f.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={},e}return Object(p.a)(n,[{key:"componentDidMount",value:function(){var e=Object(i.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement("div",{className:"main-container"},r.a.createElement("header",{className:"main-header"},"Hello!"),r.a.createElement(I,null))}}]),n}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(P,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[35,1,2]]]);
//# sourceMappingURL=main.3e295f66.chunk.js.map